<div ng-controller="enquiryController" ng-init="init()">
	<div ng-show="dashboard" class="module-dashboard-container">

		<div class="module-dashboard-content">
			<div>
				<table>
					<tr>
						<td><button type="button" class="btn btn-primary btn-lg"
								ng-click="showCriteria=!showCriteria">Search Existing</button></td>
						<td><button type="button" class="btn btn-success btn-lg"
								ng-click="resetForm()">New Enquiry</button></td>
					</tr>
				</table>
			</div>
			<div class="searchcriteria" ng-show="showCriteria">
				<table>
					<tr>
						<td><span>Enquiry No</span></td>
						<td><input type="text" ng-model="searchCriteria.inquryId"></td>
					</tr>
					<tr>
						<td><span>Course</span></td>
						<td><select ng-model="searchCriteria.courseId"></td>
					</tr>
					<tr>
						<td><span>Branch</span></td>
						<td><select ng-model="searchCriteria.branchId"></td>
					</tr>
					<tr>
						<td><span>Email Id</span></td>
						<td><input type="text" ng-model="searchCriteria.emailId"></td>
					</tr>
					<tr>
						<td><span>Mobile No</span></td>
						<td><input type="text" ng-model="searchCriteria.mobileNo"></td>
					</tr>

					<tr>
						<td><button type="button" class="btn btn-success"
								ng-click="getEnquiryBySearchCriteria()">Get Details</button></td>
					</tr>
				</table>
			</div>
		</div>

		<div class="latest-admission" ng-init="getDueEnquiry()">
			<span class="title-span">Due Enquiries</span>
			<table>
				<tr>
					<th><span>Enquiry No.</span></th>
					<th><span>Student Name</span></th>
					<th><span>Phone Name</span></th>
					<th><span>Course Name</span></th>

				</tr>
				<tr ng-repeat="object in dueEnquiries">
					<td><span ng-bind="object.fileNo"></span></td>
					<td><span ng-bind="object.firstName+' '+object.lastName"></span></td>
					<td><span ng-bind="object.fatherName"></span></td>
					<td><button type="button" class="btn btn-success btn-xs"
							ng-click="showDetail($index)">Show Detail</button></td>
				</tr>
				<tr>
					<td colspan=3><button type="button"
							class="btn btn-primary showmore" ng-click="LoadMoreData()">Load
							more data</button></td>
				</tr>

			</table>
		</div>
	</div>
	<form name="enquiryFrom" id="enquiryFrom">
		<div class="ajax-busy-indicator" ng-show="processing"></div>
		<div class="panel-div">
			<span ng-if="form.isNew">New Enquiry Process</span> <span
				ng-if="!form.isNew">{{student.firstName}}
				{{student.lastName}} ({{student.fileNo}})</span>
		</div>
		<div class="admission-fixed-div">
			<table>
				<tr>
					<td><span> Course </span></td>
					<td><select select ng-model="data.enquiry.courseId"
						ng-disabled="!form.isEdit && !form.isNew"
						ng-options="item.id*1 as item.value  for item in serverModelData.dropdownMasterData.COURSE"
						></select></td>
					<td><span> Branch </span></td>
					<td><select select ng-model="data.enquiry.branchId"
						ng-disabled="!form.isEdit && !form.isNew"
						ng-options="item.id*1 as item.value  for item in serverModelData.dropdownMasterData.BRANCH|filter: {parentId: student.courseId}"
						></select></td>
				</tr>
				<tr>
					<td><span> First Name </span></td>
					<td><input type="text" ng-model="data.enquiry.firstName" required></td>
					<td><span> Last Name </span></td>
					<td><input type="text" ng-model="data.enquiry.lastName"></td>
				</tr>
				<tr>
					<td><span> Gender </span></td>
					<td>
						<li><input type="radio" ng-model="data.enquiry.gender"
							name="gender" value='M' /><span>Male</span></li>
						<li><input type="radio" ng-model="data.enquiry.gender"
							name="gender" value='F' /><span>Female</span></li>
					</td>
					<td><span> Reminder Date </span></td>
					<td><input type="date" ng-model="data.enquiry.reminderDate"></td>
				</tr>
				<tr>
					<td><span> Remarks </span></td>
					<td><textarea ng-model="data.enquiry.remark"></textarea></td>
				</tr>
				<tr>
					<td><span class="header">TASKS</span></td>
				</tr>
				
				<tr ng-show="data.task.length == 0">
					<td>
						<span>---------No Tasks--------</span>
					</td>
				</tr>
				<tr ng-repeat="oldTask in data.task"><td>
					<span> Reminder Date </span></td>
					<td><input type="date" ng-model="oldTask.reminderDate"
						ng-Readonly="!form.isEdit && !form.isNew">
					<td ng-show=!form.isNew><span> Follow-up Remark </span></td>
					<td><textarea ng-model="oldTask.remark"></textarea></td>
				</tr>
				
				<tr>
					<td><button type="button" class="btn btn-primary"
							ng-click="addReminder=!addReminder">Add Task</button></td>
				</tr>
				<tr ng-show=addReminder>
					<td><span> Reminder Date </span></td>
					<td><input type="date" ng-model="data.task.reminderDate"
						ng-Readonly="!form.isEdit && !form.isNew"></td>
					<td ng-show=!form.isNew><span> Follow-up Remark </span></td>
					<td><textarea ng-model="data.task.remark"></textarea></td>
				</tr>
				<tr>
					<td>
						<button type="button" class="btn btn-primary"
							ng-click="addEnquiry()">Save Enquiry</button>
					</td>
					<td>
						<button type="button" class="btn btn-success" disabled=form.isNew
							ng-click="updateEnquiry()">Proceed to Admission</button>
					</td>
					<td>
						<button type="button" class="btn btn-danger"
							ng-click="getEnquiry()">Close Enquiry</button>
					</td>
				</tr>
			</table>
		</div>
	</form>
</div>
